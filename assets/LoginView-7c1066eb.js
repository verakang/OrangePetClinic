import{S as u}from"./sweetalert2.all-ac8ef29f.js";import{_ as b,r as a,o as x,c as v,b as o,a as s,w,F as V,d as L,n as p}from"./index-74bbfc2a.js";const{VITE_URL:h}={VITE_URL:"https://vue3-course-api.hexschool.io",VITE_PATH:"orangepetclinic",VITE_BLOG_PATH:"orangepetclinic-blog",BASE_URL:"/OrangePetClinic/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},k={data(){return{isLoading:!1,user:{username:"",password:""}}},methods:{checkLogin(){const n=document.cookie.replace(/(?:(?:^|.*;\s*)hexschool\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=n;const e=`${h}/v2/api/user/check`;this.$http.post(e).then(()=>{this.isLoading=!1,this.$router.push("/admin")}).catch(i=>{this.isLoading=!1,console.log(i)})},login(){const n=`${h}/v2/admin/signin`;this.$http.post(n,this.user).then(e=>{const{expired:i,token:r}=e.data;document.cookie=`hexschool=${r}; expires=${new Date(i)}`,this.$router.push("/admin"),u.fire({position:"center",icon:"success",title:"登入成功！",showConfirmButton:!1,timer:800,timerProgressBar:!0,toast:!0})}).catch(e=>{u.fire({position:"center",icon:"error",title:`${e.response.data.message}，請再次確認～`,showConfirmButton:!0,toast:!0}),this.formReset()})},formReset(){this.$refs.login.resetForm()}},mounted(){this.isLoading=!0,this.checkLogin()}},$={class:"container"},E=s("h2",{class:"text-center my-7 fst-italic"},[L("登入後台"),s("span",{class:"display-2 d-none d-lg-inline-block subtitle text-secondary"},"/Login")],-1),y={class:"row d-flex flex-column align-items-center my-10"},B={class:"mb-3"},I=s("label",{for:"exampleInputEmail1",class:"form-label"},"Email",-1),P={class:"mb-3"},R=s("label",{for:"exampleInputPassword1",class:"form-label"},"Password",-1),S=s("button",{class:"btn btn-lg btn-primary w-100 mt-3 text-white",type:"submit"}," 登入 ",-1);function T(n,e,i,r,t,f){const _=a("VueLoading"),c=a("v-field"),d=a("error-message"),g=a("v-form");return x(),v(V,null,[o(_,{active:t.isLoading,loader:"dots",color:"#1ca0b8"},null,8,["active"]),s("section",$,[E,s("div",y,[o(g,{onSubmit:f.login,id:"form",class:"form-signin col-10 col-md-8 col-lg-5",ref:"login"},{default:w(({errors:m})=>[s("div",B,[I,o(c,{name:"信箱",type:"email",class:p(["form-control",{"is-invalid":m.信箱}]),id:"exampleInputEmail1","aria-describedby":"emailHelp",placeholder:"請輸入信箱",rules:"email|required",modelValue:t.user.username,"onUpdate:modelValue":e[0]||(e[0]=l=>t.user.username=l)},null,8,["class","modelValue"]),o(d,{name:"信箱",class:"invalid-feedback"})]),s("div",P,[R,o(c,{name:"密碼",type:"password",class:p(["form-control",{"is-invalid":m.密碼}]),id:"exampleInputPassword1",placeholder:"請輸入密碼",rules:"required",modelValue:t.user.password,"onUpdate:modelValue":e[1]||(e[1]=l=>t.user.password=l)},null,8,["class","modelValue"]),o(d,{name:"密碼",class:"invalid-feedback"})]),S]),_:1},8,["onSubmit"])])])],64)}const A=b(k,[["render",T]]);export{A as default};
